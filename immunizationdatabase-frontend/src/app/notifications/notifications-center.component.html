<div class="notifications-container">
  <!-- Page Header -->
  <div class="page-header">
    <div class="header-left">
      <mat-icon class="header-icon" [matBadge]="stats.unread" matBadgeColor="warn" [matBadgeHidden]="stats.unread === 0">notifications</mat-icon>
      <div class="header-text">
        <h1>Notifications Center</h1>
        <p class="subtitle">Manage your alerts and notifications</p>
      </div>
    </div>
    <div class="header-actions">
      <button mat-raised-button (click)="refreshNotifications()">
        <mat-icon>refresh</mat-icon>
        Refresh
      </button>
      <button mat-raised-button (click)="markAllAsRead()" [disabled]="stats.unread === 0">
        <mat-icon>done_all</mat-icon>
        Mark All Read
      </button>
      <button mat-raised-button [matMenuTriggerFor]="exportMenu" color="primary">
        <mat-icon>file_download</mat-icon>
        Export
      </button>
      <mat-menu #exportMenu="matMenu">
        <button mat-menu-item (click)="exportNotifications('csv')">
          <mat-icon>description</mat-icon>
          CSV Format
        </button>
        <button mat-menu-item (click)="exportNotifications('pdf')">
          <mat-icon>picture_as_pdf</mat-icon>
          PDF Format
        </button>
      </mat-menu>
    </div>
  </div>

  <!-- Stats Cards -->
  <div class="stats-grid">
    <mat-card class="stat-card">
      <div class="stat-content">
        <div class="stat-icon total">
          <mat-icon>notifications</mat-icon>
        </div>
        <div class="stat-details">
          <div class="stat-label">Total</div>
          <div class="stat-value">{{ stats.total }}</div>
        </div>
      </div>
    </mat-card>

    <mat-card class="stat-card">
      <div class="stat-content">
        <div class="stat-icon unread">
          <mat-icon>mark_email_unread</mat-icon>
        </div>
        <div class="stat-details">
          <div class="stat-label">Unread</div>
          <div class="stat-value">{{ stats.unread }}</div>
        </div>
      </div>
    </mat-card>

    <mat-card class="stat-card">
      <div class="stat-content">
        <div class="stat-icon critical">
          <mat-icon>error</mat-icon>
        </div>
        <div class="stat-details">
          <div class="stat-label">Critical</div>
          <div class="stat-value">{{ stats.criticalAlerts }}</div>
        </div>
      </div>
    </mat-card>

    <mat-card class="stat-card">
      <div class="stat-content">
        <div class="stat-icon stock">
          <mat-icon>inventory_2</mat-icon>
        </div>
        <div class="stat-details">
          <div class="stat-label">Stock Alerts</div>
          <div class="stat-value">{{ stats.stockAlerts }}</div>
        </div>
      </div>
    </mat-card>
  </div>

  <!-- Category Tabs -->
  <mat-card class="categories-card">
    <div class="categories-grid">
      <div *ngFor="let category of categories" 
           class="category-item"
           [class.active]="filters.category === category.value"
           (click)="filterByCategory(category.value)">
        <mat-icon>{{ category.icon }}</mat-icon>
        <span class="category-label">{{ category.label }}</span>
        <span class="category-count">{{ category.count }}</span>
      </div>
    </div>
  </mat-card>

  <!-- Filters -->
  <mat-card class="filters-card">
    <div class="filters-grid">
      <mat-form-field appearance="outline">
        <mat-label>Type</mat-label>
        <mat-select [(ngModel)]="filters.type">
          <mat-option *ngFor="let type of typeOptions" [value]="type.value">
            {{ type.label }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Priority</mat-label>
        <mat-select [(ngModel)]="filters.priority">
          <mat-option *ngFor="let priority of priorityOptions" [value]="priority.value">
            {{ priority.label }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Status</mat-label>
        <mat-select [(ngModel)]="filters.status">
          <mat-option *ngFor="let status of statusOptions" [value]="status.value">
            {{ status.label }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Date Range</mat-label>
        <mat-select [(ngModel)]="filters.dateRange">
          <mat-option *ngFor="let range of dateRangeOptions" [value]="range.value">
            {{ range.label }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>
    <div class="filter-actions">
      <button mat-raised-button (click)="resetFilters()">Reset</button>
      <button mat-raised-button color="primary" (click)="applyFilters()">Apply Filters</button>
    </div>
  </mat-card>

  <!-- Bulk Actions -->
  <mat-card class="bulk-actions-card" *ngIf="selectedNotifications.size > 0">
    <div class="bulk-actions-content">
      <div class="bulk-info">
        <mat-icon>check_circle</mat-icon>
        <span>{{ selectedNotifications.size }} notification(s) selected</span>
      </div>
      <div class="bulk-buttons">
        <button mat-raised-button (click)="markSelectedAsRead()">
          <mat-icon>done_all</mat-icon>
          Mark as Read
        </button>
        <button mat-raised-button color="warn" (click)="deleteSelected()">
          <mat-icon>delete</mat-icon>
          Delete
        </button>
      </div>
    </div>
  </mat-card>

  <!-- Notifications List -->
  <mat-card class="notifications-list-card">
    <div class="list-header">
      <mat-checkbox [(ngModel)]="allSelected" (change)="toggleSelectAll()">
        Select All
      </mat-checkbox>
      <div class="list-count">
        Showing {{ filteredNotifications.length }} of {{ notifications.length }} notifications
      </div>
    </div>

    <div class="notifications-list">
      <div *ngIf="filteredNotifications.length === 0" class="empty-state">
        <mat-icon>inbox</mat-icon>
        <h3>No notifications found</h3>
        <p>Try adjusting your filters</p>
      </div>

      <div *ngFor="let notification of filteredNotifications" 
           class="notification-item"
           [class.unread]="!notification.read"
           [class.selected]="selectedNotifications.has(notification.id)">
        <div class="notification-checkbox">
          <mat-checkbox 
            [checked]="selectedNotifications.has(notification.id)"
            (change)="toggleSelection(notification.id)">
          </mat-checkbox>
        </div>

        <div class="notification-icon">
          <mat-icon [class]="getCategoryIcon(notification.category)">
            {{ getCategoryIcon(notification.category) }}
          </mat-icon>
        </div>

        <div class="notification-content" (click)="viewNotification(notification)">
          <div class="notification-header">
            <h4 class="notification-title">{{ notification.title }}</h4>
            <div class="notification-badges">
              <mat-chip [class]="getPriorityClass(notification.priority)">
                {{ notification.priority }}
              </mat-chip>
              <mat-chip [class]="getTypeClass(notification.type)">
                {{ notification.type }}
              </mat-chip>
            </div>
          </div>
          <p class="notification-message">{{ notification.message }}</p>
          <div class="notification-footer">
            <div class="notification-meta">
              <span class="notification-time">
                <mat-icon>schedule</mat-icon>
                {{ formatTimestamp(notification.timestamp) }}
              </span>
              <span class="notification-category">
                <mat-icon>{{ getCategoryIcon(notification.category) }}</mat-icon>
                {{ notification.category }}
              </span>
            </div>
          </div>
        </div>

        <div class="notification-actions">
          <button mat-icon-button [matMenuTriggerFor]="actionMenu" (click)="$event.stopPropagation()">
            <mat-icon>more_vert</mat-icon>
          </button>
          <mat-menu #actionMenu="matMenu">
            <button mat-menu-item *ngIf="!notification.read" (click)="markAsRead(notification.id)">
              <mat-icon>done</mat-icon>
              Mark as Read
            </button>
            <button mat-menu-item *ngIf="notification.read" (click)="markAsUnread(notification.id)">
              <mat-icon>mark_email_unread</mat-icon>
              Mark as Unread
            </button>
            <button mat-menu-item *ngIf="notification.actionUrl" (click)="viewNotification(notification)">
              <mat-icon>open_in_new</mat-icon>
              View Details
            </button>
            <button mat-menu-item (click)="deleteNotification(notification.id)" class="delete-action">
              <mat-icon>delete</mat-icon>
              Delete
            </button>
          </mat-menu>
        </div>
      </div>
    </div>
  </mat-card>
</div>
