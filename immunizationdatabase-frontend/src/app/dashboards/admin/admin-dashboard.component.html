<div class="dashboard-container fade-in">
  <app-loading [show]="loading" message="Loading national dashboard..."></app-loading>

  <!-- Header -->
  <header class="dashboard-header">
    <div class="header-content">
      <h1>
        <mat-icon>public</mat-icon>
        Government Official Dashboard
      </h1>
      <p class="text-secondary">National immunization monitoring and oversight</p>
    </div>
    <div class="header-actions">
      <select [(ngModel)]="selectedView" (change)="onViewChange()" class="form-control view-select">
        <option value="national">National View</option>
        <option value="district">District View</option>
        <option value="facility">Facility View</option>
      </select>
      <button class="btn btn-primary" (click)="exportNationalReport()">
        <mat-icon>download</mat-icon>
        Export Report
      </button>
    </div>
  </header>

  <!-- National Stats -->
  <div class="national-stats-grid">
    <div class="stat-card card">
      <div class="stat-icon primary">
        <mat-icon>domain</mat-icon>
      </div>
      <div class="stat-content">
        <h3>{{ nationalStats.totalFacilities }}</h3>
        <p>Health Facilities</p>
        <span class="stat-change positive">+3 this month</span>
      </div>
    </div>

    <div class="stat-card card">
      <div class="stat-icon info">
        <mat-icon>medical_services</mat-icon>
      </div>
      <div class="stat-content">
        <h3>{{ nationalStats.totalHealthWorkers }}</h3>
        <p>Health Workers</p>
        <span class="stat-change positive">+24 this month</span>
      </div>
    </div>

    <div class="stat-card card">
      <div class="stat-icon success">
        <mat-icon>people</mat-icon>
      </div>
      <div class="stat-content">
        <h3>{{ nationalStats.totalPatients | number }}</h3>
        <p>Registered Patients</p>
        <span class="stat-change positive">+1.2% this month</span>
      </div>
    </div>

    <div class="stat-card card">
      <div class="stat-icon warning">
        <mat-icon>vaccines</mat-icon>
      </div>
      <div class="stat-content">
        <h3>{{ nationalStats.totalVaccinations | number }}</h3>
        <p>Total Vaccinations</p>
        <span class="stat-change positive">+2.8% this month</span>
      </div>
    </div>

    <div class="stat-card card coverage-highlight">
      <div class="stat-icon gradient">
        <mat-icon>trending_up</mat-icon>
      </div>
      <div class="stat-content">
        <h3>{{ nationalStats.nationalCoverage }}%</h3>
        <p>National Coverage Rate</p>
        <span class="stat-change positive">+1.5% this month</span>
      </div>
    </div>

    <div class="stat-card card">
      <div class="stat-icon campaign">
        <mat-icon>campaign</mat-icon>
      </div>
      <div class="stat-content">
        <h3>{{ nationalStats.activeCampaigns }}</h3>
        <p>Active Campaigns</p>
        <span class="stat-change neutral">Nationwide</span>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="content-grid">
    <!-- District Performance -->
    <div class="card district-performance">
      <div class="card-header">
        <mat-icon>location_city</mat-icon>
        District Performance Overview
      </div>
      <div class="table-container">
        <table class="table">
          <thead>
            <tr>
              <th>District</th>
              <th>Facilities</th>
              <th>Patients</th>
              <th>Vaccinations</th>
              <th>Coverage</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let district of districtData">
              <td>
                <strong>{{ district.districtName }}</strong>
              </td>
              <td>{{ district.facilities }}</td>
              <td>{{ district.patients | number }}</td>
              <td>{{ district.vaccinations | number }}</td>
              <td>
                <span [class]="'badge ' + getCoverageClass(district.coverage)">
                  {{ district.coverage }}%
                </span>
              </td>
              <td>
                <button class="btn-icon" [routerLink]="['/districts', district.districtId]">
                  <mat-icon>visibility</mat-icon>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="card-footer">
        <a routerLink="/districts" class="link-primary">View all districts →</a>
      </div>
    </div>

    <!-- National Campaigns -->
    <div class="card campaigns-overview">
      <div class="card-header">
        <mat-icon>campaign</mat-icon>
        National Campaigns
      </div>
      <div class="campaigns-list" *ngIf="activeCampaigns.length > 0">
        <div class="campaign-item" *ngFor="let campaign of activeCampaigns.slice(0, 5)">
          <div class="campaign-info">
            <div class="campaign-header">
              <h4>{{ campaign.name }}</h4>
              <span [class]="'badge ' + getCampaignStatusClass(campaign.status)">
                {{ campaign.status }}
              </span>
            </div>
            <p class="text-secondary">{{ campaign.vaccineName }} | {{ campaign.targetAgeGroup }}</p>
            <div class="campaign-meta">
              <span>
                <mat-icon>calendar_today</mat-icon>
                {{ campaign.startDate | date: 'MMM d' }} - {{ campaign.endDate | date: 'MMM d, y' }}
              </span>
              <span>
                <mat-icon>location_on</mat-icon>
                {{ campaign.districtId || 'Nationwide' }}
              </span>
            </div>
            <div class="campaign-progress">
              <div class="progress-bar">
                <div class="progress-fill coverage-good"
                     [style.width.%]="campaign.targetPopulation ? (campaign.vaccinatedCount / campaign.targetPopulation * 100) : 0">
                </div>
              </div>
              <span class="progress-text">
                {{ campaign.vaccinatedCount | number }} / {{ campaign.targetPopulation | number }}
              </span>
            </div>
          </div>
        </div>
      </div>
      <div class="empty-state" *ngIf="activeCampaigns.length === 0">
        <mat-icon>campaign</mat-icon>
        <p>No active campaigns</p>
      </div>
      <div class="card-footer" *ngIf="activeCampaigns.length > 0">
        <a routerLink="/campaigns" class="link-primary">View all campaigns →</a>
      </div>
    </div>
  </div>

  <!-- Admin Actions -->
  <div class="admin-actions card">
    <div class="card-header">
      <mat-icon>admin_panel_settings</mat-icon>
      Administrative Actions
    </div>
    <div class="action-grid">
      <button class="action-item" routerLink="/users/manage">
        <mat-icon>manage_accounts</mat-icon>
        <span>User Management</span>
      </button>
      <button class="action-item" routerLink="/facilities/manage">
        <mat-icon>domain</mat-icon>
        <span>Facility Management</span>
      </button>
      <button class="action-item" routerLink="/reports/national">
        <mat-icon>assessment</mat-icon>
        <span>National Reports</span>
      </button>
      <button class="action-item" routerLink="/campaigns/manage">
        <mat-icon>campaign</mat-icon>
        <span>Campaign Management</span>
      </button>
      <button class="action-item" routerLink="/inventory/national">
        <mat-icon>inventory</mat-icon>
        <span>National Inventory</span>
      </button>
      <button class="action-item" routerLink="/analytics">
        <mat-icon>analytics</mat-icon>
        <span>Analytics</span>
      </button>
      <button class="action-item" routerLink="/settings/system">
        <mat-icon>settings</mat-icon>
        <span>System Settings</span>
      </button>
      <button class="action-item" routerLink="/audit">
        <mat-icon>history</mat-icon>
        <span>Audit Logs</span>
      </button>
    </div>
  </div>
</div>
