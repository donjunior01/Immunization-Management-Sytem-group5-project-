<div class="facility-settings-container">
  <!-- Page Header -->
  <div class="page-header">
    <div class="header-content">
      <div class="title-section">
        <mat-icon class="page-icon">business</mat-icon>
        <div>
          <h1>Facility Settings</h1>
          <p>Manage your facility information and operational settings</p>
        </div>
      </div>
      <div class="header-actions">
        <button mat-raised-button color="primary" (click)="startEditing()" *ngIf="!isEditing">
          <mat-icon>edit</mat-icon>
          Edit Settings
        </button>
        <button mat-stroked-button (click)="cancelEditing()" *ngIf="isEditing">
          <mat-icon>close</mat-icon>
          Cancel
        </button>
      </div>
    </div>
  </div>

  <!-- Facility Overview Card -->
  <mat-card class="overview-card" *ngIf="facility">
    <mat-card-content>
      <div class="facility-header">
        <div class="facility-logo">
          <mat-icon>local_hospital</mat-icon>
        </div>
        <div class="facility-info">
          <h2>{{ facility.name }}</h2>
          <p class="facility-code">Facility Code: {{ facility.code }}</p>
          <mat-chip [class.status-active]="facility.status === 'ACTIVE'" [class.status-inactive]="facility.status !== 'ACTIVE'">
            <mat-icon>{{ getStatusIcon() }}</mat-icon>
            {{ facility.status }}
          </mat-chip>
        </div>
      </div>
      <div class="facility-details">
        <div class="detail-item">
          <mat-icon>category</mat-icon>
          <span>{{ facility.type }}</span>
        </div>
        <div class="detail-item">
          <mat-icon>location_on</mat-icon>
          <span>{{ facility.district }}</span>
        </div>
        <div class="detail-item">
          <mat-icon>people</mat-icon>
          <span>Capacity: {{ facility.capacity }}</span>
        </div>
      </div>
    </mat-card-content>
  </mat-card>

  <!-- Facility Information -->
  <mat-card class="settings-card">
    <mat-card-header>
      <mat-card-title>
        <mat-icon>info</mat-icon>
        Facility Information
      </mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <form [formGroup]="facilityForm">
        <div class="form-grid">
          <mat-form-field appearance="outline">
            <mat-label>Facility Name</mat-label>
            <input matInput formControlName="name">
            <mat-icon matPrefix>business</mat-icon>
            <mat-error>Facility name is required</mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Facility Code</mat-label>
            <input matInput formControlName="code" readonly>
            <mat-icon matPrefix>tag</mat-icon>
            <mat-hint>Read-only</mat-hint>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Facility Type</mat-label>
            <mat-select formControlName="type">
              <mat-option *ngFor="let type of facilityTypes" [value]="type.value">
                {{ type.label }}
              </mat-option>
            </mat-select>
            <mat-icon matPrefix>category</mat-icon>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>District</mat-label>
            <input matInput formControlName="district">
            <mat-icon matPrefix>location_city</mat-icon>
            <mat-error>District is required</mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Region</mat-label>
            <input matInput formControlName="region">
            <mat-icon matPrefix>map</mat-icon>
            <mat-error>Region is required</mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Address</mat-label>
            <textarea matInput formControlName="address" rows="2"></textarea>
            <mat-icon matPrefix>location_on</mat-icon>
            <mat-error>Address is required</mat-error>
          </mat-form-field>
        </div>

        <div class="form-actions" *ngIf="isEditing">
          <button mat-raised-button color="primary" (click)="saveFacilityInfo()">
            <mat-icon>save</mat-icon>
            Save Information
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>

  <!-- Operational Settings -->
  <mat-card class="settings-card">
    <mat-card-header>
      <mat-card-title>
        <mat-icon>settings</mat-icon>
        Operational Settings
      </mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <form [formGroup]="operationalForm">
        <div class="form-grid">
          <mat-form-field appearance="outline">
            <mat-label>Patient Capacity</mat-label>
            <input matInput type="number" formControlName="capacity" min="1">
            <mat-icon matPrefix>people</mat-icon>
            <mat-hint>Maximum daily patient capacity</mat-hint>
            <mat-error>Capacity must be at least 1</mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Operating Hours</mat-label>
            <input matInput formControlName="operatingHours">
            <mat-icon matPrefix>schedule</mat-icon>
            <mat-hint>e.g., Monday-Friday: 8:00 AM - 5:00 PM</mat-hint>
            <mat-error>Operating hours are required</mat-error>
          </mat-form-field>
        </div>

        <div class="services-section">
          <h3>Services Offered</h3>
          <div class="services-grid">
            <mat-chip
              *ngFor="let service of services"
              [class.selected]="isServiceSelected(service)"
              (click)="toggleService(service)"
              [disabled]="!isEditing">
              <mat-icon>{{ isServiceSelected(service) ? 'check_circle' : 'radio_button_unchecked' }}</mat-icon>
              {{ service }}
            </mat-chip>
          </div>
        </div>

        <div class="form-actions" *ngIf="isEditing">
          <button mat-raised-button color="primary" (click)="saveOperationalSettings()">
            <mat-icon>save</mat-icon>
            Save Settings
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>

  <!-- Contact Information -->
  <mat-card class="settings-card">
    <mat-card-header>
      <mat-card-title>
        <mat-icon>contact_phone</mat-icon>
        Contact Information
      </mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <form [formGroup]="contactForm">
        <div class="form-grid">
          <mat-form-field appearance="outline">
            <mat-label>Phone Number</mat-label>
            <input matInput formControlName="phone" placeholder="0712345678">
            <mat-icon matPrefix>phone</mat-icon>
            <mat-error *ngIf="contactForm.get('phone')?.hasError('required')">
              Phone number is required
            </mat-error>
            <mat-error *ngIf="contactForm.get('phone')?.hasError('pattern')">
              Invalid phone number (10 digits required)
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Email Address</mat-label>
            <input matInput type="email" formControlName="email">
            <mat-icon matPrefix>email</mat-icon>
            <mat-error *ngIf="contactForm.get('email')?.hasError('required')">
              Email is required
            </mat-error>
            <mat-error *ngIf="contactForm.get('email')?.hasError('email')">
              Invalid email format
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-actions" *ngIf="isEditing">
          <button mat-raised-button color="primary" (click)="saveContactInfo()">
            <mat-icon>save</mat-icon>
            Save Contact Info
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>
