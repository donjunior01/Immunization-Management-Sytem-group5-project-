<div class="facility-profile-container">
  <!-- Page Header -->
  <div class="page-header">
    <div class="header-content">
      <div class="title-section">
        <mat-icon class="page-icon">apartment</mat-icon>
        <div>
          <h1>Facility Profile</h1>
          <p>Overview of your facility performance and statistics</p>
        </div>
      </div>
      <div class="header-actions">
        <button mat-raised-button color="primary" (click)="navigateToSettings()">
          <mat-icon>settings</mat-icon>
          Facility Settings
        </button>
        <button mat-stroked-button (click)="exportReport()">
          <mat-icon>download</mat-icon>
          Export Report
        </button>
      </div>
    </div>
  </div>

  <!-- Facility Overview -->
  <mat-card class="overview-card" *ngIf="facility">
    <mat-card-content>
      <div class="facility-overview">
        <div class="facility-logo">
          <mat-icon>local_hospital</mat-icon>
        </div>
        <div class="facility-details">
          <h2>{{ facility.name }}</h2>
          <p class="facility-meta">{{ facility.type }} • {{ facility.district }} • Est. {{ getYearsEstablished() }} years ago</p>
          <div class="facility-badges">
            <mat-chip [class.status-active]="facility.status === 'ACTIVE'" [class.status-inactive]="facility.status !== 'ACTIVE'">
              <mat-icon>{{ getStatusIcon() }}</mat-icon>
              {{ facility.status }}
            </mat-chip>
            <mat-chip class="region-chip">
              <mat-icon>map</mat-icon>
              {{ facility.region }}
            </mat-chip>
          </div>
        </div>
      </div>
    </mat-card-content>
  </mat-card>

  <!-- Statistics Grid -->
  <div class="stats-grid">
    <mat-card class="stat-card patients">
      <mat-card-content>
        <div class="stat-icon">
          <mat-icon>people</mat-icon>
        </div>
        <div class="stat-info">
          <div class="stat-value">{{ stats.totalPatients | number }}</div>
          <div class="stat-label">Total Patients</div>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card vaccinations">
      <mat-card-content>
        <div class="stat-icon">
          <mat-icon>vaccines</mat-icon>
        </div>
        <div class="stat-info">
          <div class="stat-value">{{ stats.vaccinationsThisMonth | number }}</div>
          <div class="stat-label">Vaccinations (This Month)</div>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card staff">
      <mat-card-content>
        <div class="stat-icon">
          <mat-icon>badge</mat-icon>
        </div>
        <div class="stat-info">
          <div class="stat-value">{{ stats.activeStaff }}</div>
          <div class="stat-label">Active Staff</div>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card inventory">
      <mat-card-content>
        <div class="stat-icon">
          <mat-icon>inventory_2</mat-icon>
        </div>
        <div class="stat-info">
          <div class="stat-value">{{ stats.vaccineBatches }}</div>
          <div class="stat-label">Vaccine Batches</div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Performance Metrics -->
  <mat-card class="metrics-card">
    <mat-card-header>
      <mat-card-title>
        <mat-icon>analytics</mat-icon>
        Performance Metrics
      </mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <div class="metrics-grid">
        <div class="metric-item" *ngFor="let metric of performanceMetrics">
          <div class="metric-header">
            <div class="metric-icon" [style.background]="metric.color">
              <mat-icon>{{ metric.icon }}</mat-icon>
            </div>
            <div class="metric-info">
              <div class="metric-label">{{ metric.label }}</div>
              <div class="metric-status" [style.color]="getPerformanceColor(metric.value, metric.target)">
                {{ getPerformanceStatus(metric.value, metric.target) }}
              </div>
            </div>
          </div>
          <div class="metric-progress">
            <div class="progress-values">
              <span class="current-value">{{ metric.value }}%</span>
              <span class="target-value">Target: {{ metric.target }}%</span>
            </div>
            <mat-progress-bar
              mode="determinate"
              [value]="(metric.value / metric.target) * 100"
              [color]="metric.value >= metric.target ? 'primary' : 'warn'">
            </mat-progress-bar>
          </div>
        </div>
      </div>
    </mat-card-content>
  </mat-card>

  <!-- Quick Actions -->
  <div class="quick-actions-grid">
    <mat-card class="action-card" (click)="navigateToUserManagement()">
      <mat-card-content>
        <div class="action-icon">
          <mat-icon>people</mat-icon>
        </div>
        <h3>Manage Staff</h3>
        <p>Add, edit, or remove staff members</p>
        <mat-icon class="arrow-icon">arrow_forward</mat-icon>
      </mat-card-content>
    </mat-card>

    <mat-card class="action-card" (click)="navigateToInventory()">
      <mat-card-content>
        <div class="action-icon">
          <mat-icon>inventory_2</mat-icon>
        </div>
        <h3>View Inventory</h3>
        <p>Check vaccine stock levels</p>
        <mat-icon class="arrow-icon">arrow_forward</mat-icon>
      </mat-card-content>
    </mat-card>

    <mat-card class="action-card" (click)="navigateToSettings()">
      <mat-card-content>
        <div class="action-icon">
          <mat-icon>settings</mat-icon>
        </div>
        <h3>Settings</h3>
        <p>Update facility information</p>
        <mat-icon class="arrow-icon">arrow_forward</mat-icon>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Staff Overview -->
  <mat-card class="staff-card">
    <mat-card-header>
      <mat-card-title>
        <mat-icon>group</mat-icon>
        Staff Members
      </mat-card-title>
      <button mat-button color="primary" (click)="navigateToUserManagement()">
        View All
        <mat-icon>arrow_forward</mat-icon>
      </button>
    </mat-card-header>
    <mat-card-content>
      <table mat-table [dataSource]="staffMembers">
        <!-- Name Column -->
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef>Name</th>
          <td mat-cell *matCellDef="let staff">
            <div class="staff-name">
              <div class="staff-avatar">{{ staff.name.charAt(0) }}</div>
              <span>{{ staff.name }}</span>
            </div>
          </td>
        </ng-container>

        <!-- Role Column -->
        <ng-container matColumnDef="role">
          <th mat-header-cell *matHeaderCellDef>Role</th>
          <td mat-cell *matCellDef="let staff">
            <mat-chip color="primary">
              <mat-icon>local_hospital</mat-icon>
              {{ staff.role }}
            </mat-chip>
          </td>
        </ng-container>

        <!-- Status Column -->
        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef>Status</th>
          <td mat-cell *matCellDef="let staff">
            <mat-chip [ngClass]="getStaffStatusClass(staff.status)">
              <mat-icon>{{ staff.status === 'Active' ? 'check_circle' : 'block' }}</mat-icon>
              {{ staff.status }}
            </mat-chip>
          </td>
        </ng-container>

        <!-- Joined Date Column -->
        <ng-container matColumnDef="joinedDate">
          <th mat-header-cell *matHeaderCellDef>Joined Date</th>
          <td mat-cell *matCellDef="let staff">{{ staff.joinedDate | date:'mediumDate' }}</td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>
    </mat-card-content>
  </mat-card>
</div>
