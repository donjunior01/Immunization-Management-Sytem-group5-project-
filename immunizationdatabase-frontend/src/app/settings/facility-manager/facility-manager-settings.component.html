<div class="settings-container">
  <div class="page-header">
    <div class="header-content">
      <div class="header-left">
        <mat-icon class="page-icon">settings</mat-icon>
        <div class="header-text">
          <h1>Settings</h1>
          <p>Manage your preferences and system configuration</p>
        </div>
      </div>
      <div class="header-actions">
        <button mat-raised-button (click)="exportSettings()" class="export-button">
          <mat-icon>download</mat-icon>
          Export
        </button>
        <input type="file" 
               #fileInput 
               (change)="importSettings($event)" 
               accept=".json" 
               style="display: none">
        <button mat-raised-button (click)="fileInput.click()" class="import-button">
          <mat-icon>upload</mat-icon>
          Import
        </button>
        <button mat-raised-button color="warn" (click)="resetAllSettings()">
          <mat-icon>restore</mat-icon>
          Reset All
        </button>
      </div>
    </div>
  </div>

  <mat-tab-group class="settings-tabs" animationDuration="300ms">
    <!-- General Settings Tab -->
    <mat-tab>
      <ng-template mat-tab-label>
        <mat-icon>language</mat-icon>
        General
      </ng-template>
      
      <mat-card class="settings-card">
        <div class="card-header">
          <h2>
            <mat-icon>language</mat-icon>
            General Settings
          </h2>
          <p>Configure language, timezone, and regional preferences</p>
        </div>

        <form [formGroup]="generalForm" class="settings-form">
          <div class="form-grid">
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Language</mat-label>
              <mat-select formControlName="language">
                <mat-option *ngFor="let option of languageOptions" [value]="option.value">
                  {{ option.label }}
                </mat-option>
              </mat-select>
              <mat-icon matPrefix>translate</mat-icon>
            </mat-form-field>

            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Timezone</mat-label>
              <mat-select formControlName="timezone">
                <mat-option *ngFor="let option of timezoneOptions" [value]="option.value">
                  {{ option.label }}
                </mat-option>
              </mat-select>
              <mat-icon matPrefix>schedule</mat-icon>
            </mat-form-field>

            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Date Format</mat-label>
              <mat-select formControlName="dateFormat">
                <mat-option *ngFor="let option of dateFormatOptions" [value]="option.value">
                  {{ option.label }}
                </mat-option>
              </mat-select>
              <mat-icon matPrefix>event</mat-icon>
            </mat-form-field>

            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Time Format</mat-label>
              <mat-select formControlName="timeFormat">
                <mat-option *ngFor="let option of timeFormatOptions" [value]="option.value">
                  {{ option.label }}
                </mat-option>
              </mat-select>
              <mat-icon matPrefix>access_time</mat-icon>
            </mat-form-field>

            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Currency</mat-label>
              <mat-select formControlName="currency">
                <mat-option *ngFor="let option of currencyOptions" [value]="option.value">
                  {{ option.label }}
                </mat-option>
              </mat-select>
              <mat-icon matPrefix>attach_money</mat-icon>
            </mat-form-field>
          </div>

          <div class="form-actions">
            <button mat-button type="button" (click)="resetGeneralSettings()">
              <mat-icon>refresh</mat-icon>
              Reset
            </button>
            <button mat-raised-button type="button" (click)="saveGeneralSettings()" class="save-button">
              <mat-icon>save</mat-icon>
              Save Changes
            </button>
          </div>
        </form>
      </mat-card>
    </mat-tab>

    <!-- Notification Settings Tab -->
    <mat-tab>
      <ng-template mat-tab-label>
        <mat-icon>notifications</mat-icon>
        Notifications
      </ng-template>
      
      <mat-card class="settings-card">
        <div class="card-header">
          <h2>
            <mat-icon>notifications</mat-icon>
            Notification Settings
          </h2>
          <p>Manage how and when you receive notifications</p>
        </div>

        <form [formGroup]="notificationForm" class="settings-form">
          <div class="toggle-section">
            <h3>Notification Channels</h3>
            <div class="toggle-grid">
              <mat-slide-toggle formControlName="emailNotifications">
                <mat-icon>email</mat-icon>
                Email Notifications
              </mat-slide-toggle>

              <mat-slide-toggle formControlName="smsNotifications">
                <mat-icon>sms</mat-icon>
                SMS Notifications
              </mat-slide-toggle>

              <mat-slide-toggle formControlName="pushNotifications">
                <mat-icon>notifications_active</mat-icon>
                Push Notifications
              </mat-slide-toggle>
            </div>
          </div>

          <mat-divider></mat-divider>

          <div class="toggle-section">
            <h3>Alert Types</h3>
            <div class="toggle-grid">
              <mat-slide-toggle formControlName="lowStockAlerts">
                <mat-icon>inventory</mat-icon>
                Low Stock Alerts
              </mat-slide-toggle>

              <mat-slide-toggle formControlName="expiryAlerts">
                <mat-icon>event_busy</mat-icon>
                Expiry Alerts
              </mat-slide-toggle>

              <mat-slide-toggle formControlName="campaignReminders">
                <mat-icon>campaign</mat-icon>
                Campaign Reminders
              </mat-slide-toggle>

              <mat-slide-toggle formControlName="systemUpdates">
                <mat-icon>system_update</mat-icon>
                System Updates
              </mat-slide-toggle>
            </div>
          </div>

          <mat-divider></mat-divider>

          <div class="form-grid">
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Notification Frequency</mat-label>
              <mat-select formControlName="notificationFrequency">
                <mat-option *ngFor="let option of notificationFrequencyOptions" [value]="option.value">
                  {{ option.label }}
                </mat-option>
              </mat-select>
              <mat-icon matPrefix>schedule</mat-icon>
            </mat-form-field>
          </div>

          <div class="form-actions">
            <button mat-button type="button" (click)="testNotifications()">
              <mat-icon>send</mat-icon>
              Test Notifications
            </button>
            <button mat-button type="button" (click)="resetNotificationSettings()">
              <mat-icon>refresh</mat-icon>
              Reset
            </button>
            <button mat-raised-button type="button" (click)="saveNotificationSettings()" class="save-button">
              <mat-icon>save</mat-icon>
              Save Changes
            </button>
          </div>
        </form>
      </mat-card>
    </mat-tab>

    <!-- Security Settings Tab -->
    <mat-tab>
      <ng-template mat-tab-label>
        <mat-icon>security</mat-icon>
        Security
      </ng-template>
      
      <mat-card class="settings-card">
        <div class="card-header">
          <h2>
            <mat-icon>security</mat-icon>
            Security Settings
          </h2>
          <p>Manage your account security and privacy</p>
        </div>

        <form [formGroup]="securityForm" class="settings-form">
          <div class="toggle-section">
            <h3>Authentication</h3>
            <div class="toggle-grid">
              <div class="toggle-item-with-button">
                <mat-slide-toggle formControlName="twoFactorAuth">
                  <mat-icon>lock</mat-icon>
                  Two-Factor Authentication
                </mat-slide-toggle>
                <button mat-button 
                        *ngIf="securityForm.get('twoFactorAuth')?.value"
                        (click)="enable2FA()">
                  <mat-icon>settings</mat-icon>
                  Configure
                </button>
              </div>

              <mat-slide-toggle formControlName="loginNotifications">
                <mat-icon>notification_important</mat-icon>
                Login Notifications
              </mat-slide-toggle>

              <mat-slide-toggle formControlName="trustedDevicesOnly">
                <mat-icon>verified_user</mat-icon>
                Trusted Devices Only
              </mat-slide-toggle>
            </div>
          </div>

          <mat-divider></mat-divider>

          <div class="form-grid">
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Session Timeout</mat-label>
              <mat-select formControlName="sessionTimeout">
                <mat-option *ngFor="let option of sessionTimeoutOptions" [value]="option.value">
                  {{ option.label }}
                </mat-option>
              </mat-select>
              <mat-icon matPrefix>timer</mat-icon>
            </mat-form-field>

            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Password Expiry</mat-label>
              <mat-select formControlName="passwordExpiry">
                <mat-option *ngFor="let option of passwordExpiryOptions" [value]="option.value">
                  {{ option.label }}
                </mat-option>
              </mat-select>
              <mat-icon matPrefix>vpn_key</mat-icon>
            </mat-form-field>
          </div>

          <div class="form-actions">
            <button mat-button type="button" (click)="resetSecuritySettings()">
              <mat-icon>refresh</mat-icon>
              Reset
            </button>
            <button mat-raised-button type="button" (click)="saveSecuritySettings()" class="save-button">
              <mat-icon>save</mat-icon>
              Save Changes
            </button>
          </div>
        </form>
      </mat-card>
    </mat-tab>

    <!-- Display Settings Tab -->
    <mat-tab>
      <ng-template mat-tab-label>
        <mat-icon>palette</mat-icon>
        Display
      </ng-template>
      
      <mat-card class="settings-card">
        <div class="card-header">
          <h2>
            <mat-icon>palette</mat-icon>
            Display Settings
          </h2>
          <p>Customize the look and feel of your interface</p>
        </div>

        <form [formGroup]="displayForm" class="settings-form">
          <div class="theme-section">
            <h3>Theme</h3>
            <div class="theme-options">
              <mat-card *ngFor="let theme of themeOptions" 
                        class="theme-card"
                        [class.selected]="displayForm.get('theme')?.value === theme.value"
                        (click)="displayForm.patchValue({ theme: theme.value })">
                <mat-icon>{{ theme.icon }}</mat-icon>
                <div class="theme-label">{{ theme.label }}</div>
              </mat-card>
            </div>
          </div>

          <mat-divider></mat-divider>

          <div class="toggle-section">
            <h3>Interface Options</h3>
            <div class="toggle-grid">
              <mat-slide-toggle formControlName="sidebarCollapsed">
                <mat-icon>view_sidebar</mat-icon>
                Collapsed Sidebar
              </mat-slide-toggle>

              <mat-slide-toggle formControlName="compactMode">
                <mat-icon>compress</mat-icon>
                Compact Mode
              </mat-slide-toggle>

              <mat-slide-toggle formControlName="showTooltips">
                <mat-icon>help_outline</mat-icon>
                Show Tooltips
              </mat-slide-toggle>

              <mat-slide-toggle formControlName="animationsEnabled">
                <mat-icon>animation</mat-icon>
                Animations Enabled
              </mat-slide-toggle>

              <mat-slide-toggle formControlName="highContrast">
                <mat-icon>contrast</mat-icon>
                High Contrast
              </mat-slide-toggle>
            </div>
          </div>

          <div class="form-actions">
            <button mat-button type="button" (click)="resetDisplaySettings()">
              <mat-icon>refresh</mat-icon>
              Reset
            </button>
            <button mat-raised-button type="button" (click)="saveDisplaySettings()" class="save-button">
              <mat-icon>save</mat-icon>
              Save Changes
            </button>
          </div>
        </form>
      </mat-card>
    </mat-tab>

    <!-- Data Settings Tab -->
    <mat-tab>
      <ng-template mat-tab-label>
        <mat-icon>storage</mat-icon>
        Data
      </ng-template>
      
      <mat-card class="settings-card">
        <div class="card-header">
          <h2>
            <mat-icon>storage</mat-icon>
            Data Settings
          </h2>
          <p>Manage data storage, backup, and export preferences</p>
        </div>

        <form [formGroup]="dataForm" class="settings-form">
          <div class="form-grid">
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Auto-Save Interval</mat-label>
              <mat-select formControlName="autoSaveInterval">
                <mat-option *ngFor="let option of autoSaveIntervalOptions" [value]="option.value">
                  {{ option.label }}
                </mat-option>
              </mat-select>
              <mat-icon matPrefix>save</mat-icon>
            </mat-form-field>

            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Backup Frequency</mat-label>
              <mat-select formControlName="backupFrequency">
                <mat-option *ngFor="let option of backupFrequencyOptions" [value]="option.value">
                  {{ option.label }}
                </mat-option>
              </mat-select>
              <mat-icon matPrefix>backup</mat-icon>
            </mat-form-field>

            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Data Retention Period</mat-label>
              <mat-select formControlName="dataRetention">
                <mat-option *ngFor="let option of dataRetentionOptions" [value]="option.value">
                  {{ option.label }}
                </mat-option>
              </mat-select>
              <mat-icon matPrefix>history</mat-icon>
            </mat-form-field>

            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Default Export Format</mat-label>
              <mat-select formControlName="exportFormat">
                <mat-option *ngFor="let option of exportFormatOptions" [value]="option.value">
                  {{ option.label }}
                </mat-option>
              </mat-select>
              <mat-icon matPrefix>file_download</mat-icon>
            </mat-form-field>
          </div>

          <div class="form-actions">
            <button mat-button type="button" (click)="resetDataSettings()">
              <mat-icon>refresh</mat-icon>
              Reset
            </button>
            <button mat-raised-button type="button" (click)="saveDataSettings()" class="save-button">
              <mat-icon>save</mat-icon>
              Save Changes
            </button>
          </div>
        </form>
      </mat-card>
    </mat-tab>
  </mat-tab-group>
</div>
