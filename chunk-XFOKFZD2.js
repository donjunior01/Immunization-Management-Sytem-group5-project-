import{a as $}from"./chunk-624THPQG.js";import"./chunk-K7JKQVDZ.js";import"./chunk-FP7EL6KI.js";import{a as H}from"./chunk-YTZ64FHX.js";import{a as _}from"./chunk-Y7V3HG6R.js";import{a as W}from"./chunk-QHILUX33.js";import{a as U}from"./chunk-RB2IKARN.js";import"./chunk-7UZYWCAJ.js";import"./chunk-MLMGL4QO.js";import{a as Y}from"./chunk-4G3G25LR.js";import{b as I,c as f,d as D,e as T,f as L,g as X,k as A,l as R,m as z,n as j,o as G,t as q,u as Q,v as B}from"./chunk-VLP6GBL3.js";import{e as N}from"./chunk-K3XQKY74.js";import{A as g,Aa as y,B as u,Ba as w,Ca as S,Oa as O,P as l,Sa as V,Ta as E,U as x,V as P,Z as C,_a as F,ba as d,ca as n,da as e,ea as p,ka as b,la as m,ma as c,mb as k,va as i,xa as v,ya as M}from"./chunk-T4RMSDZY.js";function K(s,a){if(s&1){let t=b();n(0,"app-alert",12),m("dismiss",function(){g(t);let o=c();return u(o.errorMessage="")}),e()}if(s&2){let t=c();d("message",t.errorMessage)("show",!!t.errorMessage)}}function Z(s,a){if(s&1){let t=b();n(0,"app-alert",13),m("dismiss",function(){g(t);let o=c();return u(o.successMessage="")}),e()}if(s&2){let t=c();d("message",t.successMessage)("show",!!t.successMessage)}}function ee(s,a){if(s&1&&(n(0,"p")(1,"strong"),i(2,"Village:"),e(),i(3),e()),s&2){let t=c().$implicit;l(3),v(" ",t.village)}}function te(s,a){if(s&1){let t=b();n(0,"div",14),m("click",function(){let o=g(t).$implicit,h=c();return u(h.viewPatient(o))}),n(1,"div",15)(2,"h3"),i(3),e(),n(4,"span",16),i(5),e()(),n(6,"div",17)(7,"p")(8,"strong"),i(9,"Guardian:"),e(),i(10),e(),n(11,"p")(12,"strong"),i(13,"Phone:"),e(),i(14),e(),C(15,ee,4,1,"p",11),e()()}if(s&2){let t=a.$implicit,r=c();l(3),M("",t.firstName," ",t.lastName),l(2),v("",r.getPatientAge(t.birthDate)," months"),l(5),v(" ",t.guardianName),l(4),v(" ",t.guardianPhone),l(),d("ngIf",t.village)}}function ne(s,a){if(s&1){let t=b();n(0,"div",18),m("click",function(){g(t);let o=c();return u(o.closeForm())}),n(1,"div",19),m("click",function(o){return g(t),u(o.stopPropagation())}),n(2,"div",20)(3,"h2"),i(4,"Register New Patient"),e(),n(5,"button",21),m("click",function(){g(t);let o=c();return u(o.closeForm())}),i(6,"\xD7"),e()(),n(7,"form",22),m("ngSubmit",function(){g(t);let o=c();return u(o.onSubmit())}),n(8,"div",23)(9,"div",24)(10,"label"),i(11,"First Name *"),e(),p(12,"input",25),e(),n(13,"div",24)(14,"label"),i(15,"Last Name *"),e(),p(16,"input",26),e()(),n(17,"div",24)(18,"label"),i(19,"Date of Birth *"),e(),p(20,"input",27),e(),n(21,"div",24)(22,"label"),i(23,"Gender *"),e(),n(24,"select",28)(25,"option",29),i(26,"Male"),e(),n(27,"option",30),i(28,"Female"),e()()(),n(29,"div",24)(30,"label"),i(31,"Guardian Name *"),e(),p(32,"input",31),e(),n(33,"div",24)(34,"label"),i(35,"Guardian Phone * (+237XXXXXXXXX)"),e(),p(36,"input",32),e(),n(37,"div",24)(38,"label"),i(39,"National ID"),e(),p(40,"input",33),e(),n(41,"div",24)(42,"label"),i(43,"Village"),e(),p(44,"input",34),e(),n(45,"div",24)(46,"label"),i(47,"Address"),e(),p(48,"textarea",35),e(),n(49,"div",36)(50,"button",37),m("click",function(){g(t);let o=c();return u(o.closeForm())}),i(51,"Cancel"),e(),n(52,"button",38),i(53," Register Patient "),e()()()()()}if(s&2){let t=c();l(7),d("formGroup",t.patientForm),l(45),d("disabled",t.patientForm.invalid||t.loading)}}function ie(s,a){s&1&&p(0,"app-loader")}var J=class s{constructor(a,t,r,o){this.patientService=a;this.authService=t;this.fb=r;this.cdr=o;this.patientForm=this.fb.group({firstName:["",[f.required]],lastName:["",[f.required]],birthDate:["",[f.required]],gender:["MALE",[f.required]],guardianName:["",[f.required]],guardianPhone:["",[f.required,f.pattern(/^\+237\d{9}$/)]],nationalId:[""],village:[""],address:[""]})}patients=[];searchQuery="";loading=!1;showCreateForm=!1;selectedPatient=null;errorMessage="";successMessage="";patientForm;isLoadingData=!1;ngOnInit(){this.loadPatients()}loadPatients(){if(this.isLoadingData)return;this.isLoadingData=!0,this.loading=!0;let a=Date.now(),r=this.authService?.getCurrentUser()?.facilityId;this.patientService.searchPatients("",r).subscribe({next:o=>{this.patients=o.patients||[],_(a,()=>{this.loading=!1,this.isLoadingData=!1,this.cdr.detectChanges()})},error:o=>{this.errorMessage="Failed to load patients",this.patients=[],_(a,()=>{this.loading=!1,this.isLoadingData=!1,this.cdr.detectChanges()})}})}onSearch(){if(this.isLoadingData)return;this.isLoadingData=!0,this.loading=!0;let a=Date.now(),r=this.authService?.getCurrentUser()?.facilityId;this.searchQuery.trim()?this.patientService.searchPatients(this.searchQuery,r).subscribe({next:o=>{this.patients=o.patients||[],_(a,()=>{this.loading=!1,this.isLoadingData=!1,this.cdr.detectChanges()})},error:o=>{this.errorMessage="Failed to search patients",this.patients=[],_(a,()=>{this.loading=!1,this.isLoadingData=!1,this.cdr.detectChanges()})}}):this.loadPatients()}openCreateForm(){this.patientForm.reset({gender:"MALE"}),this.showCreateForm=!0,this.selectedPatient=null}closeForm(){this.showCreateForm=!1,this.selectedPatient=null,this.patientForm.reset()}onSubmit(){if(this.patientForm.valid){this.loading=!0;let a=Date.now(),t=this.patientForm.value;this.patientService.createPatient(t).subscribe({next:()=>{this.successMessage="Patient registered successfully",this.closeForm(),_(a,()=>{this.loadPatients(),this.loading=!1})},error:r=>{this.errorMessage="Failed to register patient",_(a,()=>{this.loading=!1})}})}}getPatientAge(a){return a?$(new Date,new Date(a)):0}viewPatient(a){this.selectedPatient=a}static \u0275fac=function(t){return new(t||s)(x(H),x(N),x(q),x(O))};static \u0275cmp=P({type:s,selectors:[["app-vaccinator-patients"]],decls:20,vars:6,consts:[[1,"patients-page"],[1,"page-header"],[1,"subtitle"],[1,"btn","btn-primary",3,"click"],["type","error",3,"message","show","dismiss",4,"ngIf"],["type","success",3,"message","show","dismiss",4,"ngIf"],[1,"search-bar"],["type","text","placeholder","Search by name, phone, or patient ID...",1,"search-input",3,"ngModelChange","keyup.enter","ngModel"],[1,"patients-grid"],["class","patient-card",3,"click",4,"ngFor","ngForOf"],["class","modal-overlay",3,"click",4,"ngIf"],[4,"ngIf"],["type","error",3,"dismiss","message","show"],["type","success",3,"dismiss","message","show"],[1,"patient-card",3,"click"],[1,"patient-header"],[1,"patient-age"],[1,"patient-details"],[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"modal-header"],[1,"modal-close",3,"click"],[1,"modal-body",3,"ngSubmit","formGroup"],[1,"form-row"],[1,"form-group"],["type","text","formControlName","firstName",1,"form-control"],["type","text","formControlName","lastName",1,"form-control"],["type","date","formControlName","birthDate",1,"form-control"],["formControlName","gender",1,"form-control"],["value","MALE"],["value","FEMALE"],["type","text","formControlName","guardianName",1,"form-control"],["type","tel","formControlName","guardianPhone","placeholder","+237XXXXXXXXX",1,"form-control"],["type","text","formControlName","nationalId",1,"form-control"],["type","text","formControlName","village",1,"form-control"],["formControlName","address","rows","3",1,"form-control"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled"]],template:function(t,r){t&1&&(n(0,"app-layout")(1,"div",0)(2,"div",1)(3,"div")(4,"h1"),i(5,"Patient Management"),e(),n(6,"p",2),i(7,"Register and search for patients"),e()(),n(8,"button",3),m("click",function(){return r.openCreateForm()}),i(9,"+ Register Patient"),e()(),C(10,K,1,2,"app-alert",4)(11,Z,1,2,"app-alert",5),n(12,"div",6)(13,"input",7),S("ngModelChange",function(h){return w(r.searchQuery,h)||(r.searchQuery=h),h}),m("keyup.enter",function(){return r.onSearch()}),e(),n(14,"button",3),m("click",function(){return r.onSearch()}),i(15,"Search"),e()(),n(16,"div",8),C(17,te,16,6,"div",9),e(),C(18,ne,54,2,"div",10)(19,ie,1,0,"app-loader",11),e()()),t&2&&(l(10),d("ngIf",r.errorMessage),l(),d("ngIf",r.successMessage),l(2),y("ngModel",r.searchQuery),l(4),d("ngForOf",r.patients),l(),d("ngIf",r.showCreateForm),l(),d("ngIf",r.loading))},dependencies:[F,V,E,B,X,j,G,I,z,D,T,R,A,Q,L,k,Y,W,U],styles:[".patients-page[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:700;color:#333;margin:0 0 .5rem}.page-header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{color:#666;font-size:1.1rem;margin:0}.search-bar[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-bottom:2rem;background:#fff;padding:1rem;border-radius:12px;box-shadow:0 2px 8px #0000001a}.search-input[_ngcontent-%COMP%]{flex:1;padding:.75rem;border:2px solid #e0e0e0;border-radius:8px;font-size:1rem}.search-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#667eea}.patients-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:1.5rem}.patient-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:1.5rem;box-shadow:0 2px 8px #0000001a;cursor:pointer;transition:all .3s ease}.patient-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 4px 16px #00000026}.patient-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;padding-bottom:1rem;border-bottom:1px solid #f0f0f0}.patient-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.25rem;color:#333}.patient-header[_ngcontent-%COMP%]   .patient-age[_ngcontent-%COMP%]{color:#667eea;font-weight:500}.patient-details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.5rem 0;color:#666;font-size:.9rem}.patient-details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#333}.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#0009;display:flex;justify-content:center;align-items:center;z-index:10000;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.modal-content[_ngcontent-%COMP%]{background:#fff;border-radius:12px;max-width:700px;width:90%;max-height:90vh;overflow-y:auto;box-shadow:0 10px 40px #0003}.modal-header[_ngcontent-%COMP%]{padding:1.5rem;border-bottom:1px solid #e0e0e0;display:flex;justify-content:space-between;align-items:center}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;font-weight:600}.modal-close[_ngcontent-%COMP%]{background:none;border:none;font-size:1.5rem;cursor:pointer;color:#666;padding:0;width:32px;height:32px;display:flex;align-items:center;justify-content:center;border-radius:4px;transition:all .2s}.modal-close[_ngcontent-%COMP%]:hover{background:#f0f0f0}.modal-body[_ngcontent-%COMP%]{padding:1.5rem}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1rem}.form-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;color:#333;font-weight:500}.form-control[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:2px solid #e0e0e0;border-radius:8px;font-size:1rem;transition:all .2s;box-sizing:border-box;font-family:inherit}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#667eea;box-shadow:0 0 0 3px #667eea1a}.modal-footer[_ngcontent-%COMP%]{padding:1.5rem;border-top:1px solid #e0e0e0;display:flex;justify-content:flex-end;gap:1rem}.btn[_ngcontent-%COMP%]{padding:.75rem 1.5rem;border:none;border-radius:8px;font-size:1rem;font-weight:600;cursor:pointer;transition:all .2s}.btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 4px 12px #667eea66}.btn-secondary[_ngcontent-%COMP%]{background:#f0f0f0;color:#333}.btn-secondary[_ngcontent-%COMP%]:hover{background:#e0e0e0}@media(max-width:768px){.page-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:1rem}.patients-grid[_ngcontent-%COMP%], .form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})};export{J as VaccinatorPatientsComponent};
