import{b as l}from"./chunk-H32AX7W2.js";import{bb as o,db as h,i as r,j as d,k as a,n as u,v as c,z as f}from"./chunk-T4RMSDZY.js";var g=class m{http=f(h);apiUrl=l.apiUrl;getAppointments(t,n){let i=new o;return t&&(i=i.set("facilityId",t)),n&&(i=i.set("date",n)),this.http.get(`${this.apiUrl}/api/appointments`,{params:i}).pipe(d(8e3),a(e=>e.map(p=>this.mapBackendToFrontend(p))),u(e=>(console.error("Error fetching appointments:",e),r(()=>e))))}mapBackendToFrontend(t){let n="";if(t.appointmentDate){if(typeof t.appointmentDate=="string")n=t.appointmentDate;else if(t.appointmentDate.year&&t.appointmentDate.month&&t.appointmentDate.day){let e=t.appointmentDate.year,p=String(t.appointmentDate.monthValue||t.appointmentDate.month).padStart(2,"0"),D=String(t.appointmentDate.dayOfMonth||t.appointmentDate.day).padStart(2,"0");n=`${e}-${p}-${D}`}}let i;if(t.appointmentTime){if(typeof t.appointmentTime=="string")i=t.appointmentTime;else if(t.appointmentTime.hour!==void 0){let e=String(t.appointmentTime.hour).padStart(2,"0"),p=String(t.appointmentTime.minute||0).padStart(2,"0");i=`${e}:${p}`}}return{id:t.id?String(t.id):"",patientId:t.patientId?String(t.patientId):"",patientName:t.patientName||"Unknown",patientAge:t.patientAge||void 0,guardianName:t.guardianName||void 0,guardianPhone:t.guardianPhone||t.phoneNumber||void 0,vaccineName:t.vaccineName||"",doseNumber:t.doseNumber||1,appointmentDate:n,appointmentTime:i,facilityId:t.facilityId||"",facilityName:t.facilityName||void 0,status:t.status||"SCHEDULED",notes:t.notes||void 0,smsSent:t.smsSent||!1,smsSentDate:t.smsSentDate||t.smsSentAt||void 0,createdAt:t.createdAt||new Date().toISOString()}}getAppointmentById(t){return this.http.get(`${this.apiUrl}/api/appointments/${t}`).pipe(a(n=>this.mapBackendToFrontend(n)))}createAppointment(t){return this.http.post(`${this.apiUrl}/api/appointments`,t).pipe(a(n=>this.mapBackendToFrontend(n)))}updateAppointment(t,n){return this.http.put(`${this.apiUrl}/api/appointments/${t}`,n).pipe(a(i=>this.mapBackendToFrontend(i)))}deleteAppointment(t){return this.http.delete(`${this.apiUrl}/api/appointments/${t}`)}getPatientAppointments(t){let n=new o().set("patientId",t);return this.http.get(`${this.apiUrl}/api/appointments`,{params:n}).pipe(a(i=>i.map(e=>this.mapBackendToFrontend(e))))}static \u0275fac=function(n){return new(n||m)};static \u0275prov=c({token:m,factory:m.\u0275fac,providedIn:"root"})};export{g as a};
