import{a as X}from"./chunk-GKA4VUJU.js";import{a as g}from"./chunk-Y7V3HG6R.js";import{a as $}from"./chunk-QHILUX33.js";import{a as J}from"./chunk-RB2IKARN.js";import"./chunk-7UZYWCAJ.js";import{c as S,d as U,f as C,g as A}from"./chunk-MLMGL4QO.js";import{a as Q}from"./chunk-4G3G25LR.js";import{b as R,c as h,d as z,e as L,g as G,k as j,l as H,m as Y,n as q,o as W,t as K,v as B}from"./chunk-VLP6GBL3.js";import{a as V,b as D}from"./chunk-K3XQKY74.js";import{A as p,B as u,F,P as s,Ra as M,Sa as I,Ta as w,U as P,V as v,Z as b,_a as O,a as T,ba as c,ca as n,da as t,ea as _,ka as x,la as d,ma as m,mb as N,va as i,wa as f,xa as y}from"./chunk-T4RMSDZY.js";function ie(l,o){if(l&1){let e=x();n(0,"div",1),d("click",function(){p(e);let a=m();return u(a.onCancel())}),n(1,"div",2),d("click",function(a){return p(e),u(a.stopPropagation())}),n(2,"div",3)(3,"h3",4),i(4),t(),n(5,"button",5),d("click",function(){p(e);let a=m();return u(a.onCancel())}),i(6,"\xD7"),t()(),n(7,"div",6)(8,"p",7),i(9),t()(),n(10,"div",8)(11,"button",9),d("click",function(){p(e);let a=m();return u(a.onCancel())}),i(12),t(),n(13,"button",10),d("click",function(){p(e);let a=m();return u(a.onConfirm())}),i(14),t()()()()}if(l&2){let e=m();c("@fadeIn",void 0),s(),c("@slideIn",void 0),s(3),f(e.title),s(5),f(e.message),s(3),f(e.cancelText),s(),c("ngClass","btn-"+e.type),s(),f(e.confirmText)}}var k=class l{title="Confirm Action";message="Are you sure you want to proceed?";confirmText="Confirm";cancelText="Cancel";type="info";show=!1;confirmed=new F;cancelled=new F;onConfirm(){this.confirmed.emit()}onCancel(){this.cancelled.emit()}static \u0275fac=function(e){return new(e||l)};static \u0275cmp=v({type:l,selectors:[["app-confirmation-modal"]],inputs:{title:"title",message:"message",confirmText:"confirmText",cancelText:"cancelText",type:"type",show:"show"},outputs:{confirmed:"confirmed",cancelled:"cancelled"},decls:1,vars:1,consts:[["class","modal-overlay",3,"click",4,"ngIf"],[1,"modal-overlay",3,"click"],[1,"modal-container",3,"click"],[1,"modal-header"],[1,"modal-title"],["aria-label","Close",1,"modal-close",3,"click"],[1,"modal-body"],[1,"modal-message"],[1,"modal-footer"],[1,"btn","btn-secondary",3,"click"],[1,"btn",3,"click","ngClass"]],template:function(e,r){e&1&&b(0,ie,15,7,"div",0),e&2&&c("ngIf",r.show)},dependencies:[O,M,w],styles:[".modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#0009;display:flex;justify-content:center;align-items:center;z-index:10000;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.modal-container[_ngcontent-%COMP%]{background:#fff;border-radius:12px;box-shadow:0 10px 40px #0003;max-width:500px;width:90%;max-height:90vh;overflow:hidden;display:flex;flex-direction:column}.modal-header[_ngcontent-%COMP%]{padding:1.5rem;border-bottom:1px solid #e0e0e0;display:flex;justify-content:space-between;align-items:center}.modal-title[_ngcontent-%COMP%]{margin:0;font-size:1.25rem;font-weight:600;color:#333}.modal-close[_ngcontent-%COMP%]{background:none;border:none;font-size:1.5rem;cursor:pointer;color:#666;padding:0;width:32px;height:32px;display:flex;align-items:center;justify-content:center;border-radius:4px;transition:all .2s}.modal-close[_ngcontent-%COMP%]:hover{background:#f0f0f0;color:#333}.modal-body[_ngcontent-%COMP%]{padding:1.5rem;flex:1;overflow-y:auto}.modal-message[_ngcontent-%COMP%]{margin:0;color:#666;line-height:1.6;font-size:1rem}.modal-footer[_ngcontent-%COMP%]{padding:1.5rem;border-top:1px solid #e0e0e0;display:flex;justify-content:flex-end;gap:1rem}.btn[_ngcontent-%COMP%]{padding:.75rem 1.5rem;border:none;border-radius:6px;font-size:.95rem;font-weight:500;cursor:pointer;transition:all .2s}.btn[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 8px #00000026}.btn[_ngcontent-%COMP%]:active{transform:translateY(0)}.btn-secondary[_ngcontent-%COMP%]{background:#f0f0f0;color:#333}.btn-secondary[_ngcontent-%COMP%]:hover{background:#e0e0e0}.btn-danger[_ngcontent-%COMP%]{background:#dc3545;color:#fff}.btn-danger[_ngcontent-%COMP%]:hover{background:#c82333}.btn-warning[_ngcontent-%COMP%]{background:#ffc107;color:#333}.btn-warning[_ngcontent-%COMP%]:hover{background:#e0a800}.btn-info[_ngcontent-%COMP%]{background:#17a2b8;color:#fff}.btn-info[_ngcontent-%COMP%]:hover{background:#138496}"],data:{animation:[S("fadeIn",[A(":enter",[C({opacity:0}),U("200ms ease-out",C({opacity:1}))])]),S("slideIn",[A(":enter",[C({opacity:0,transform:"scale(0.9) translateY(-20px)"}),U("300ms ease-out",C({opacity:1,transform:"scale(1) translateY(0)"}))])])]}})};function oe(l,o){if(l&1){let e=x();n(0,"app-alert",12),d("dismiss",function(){p(e);let a=m();return u(a.errorMessage="")}),t()}if(l&2){let e=m();c("message",e.errorMessage)("show",!!e.errorMessage)}}function re(l,o){if(l&1){let e=x();n(0,"app-alert",13),d("dismiss",function(){p(e);let a=m();return u(a.successMessage="")}),t()}if(l&2){let e=m();c("message",e.successMessage)("show",!!e.successMessage)}}function ae(l,o){if(l&1){let e=x();n(0,"tr")(1,"td"),i(2),t(),n(3,"td"),i(4),t(),n(5,"td")(6,"span",14),i(7),t()(),n(8,"td"),i(9),t(),n(10,"td")(11,"span",15),i(12),t()(),n(13,"td")(14,"div",16)(15,"button",17),d("click",function(){let a=p(e).$implicit,E=m();return u(E.openEditForm(a))}),i(16,"\u270F\uFE0F"),t(),n(17,"button",18),d("click",function(){let a=p(e).$implicit,E=m();return u(E.openDeleteModal(a))}),i(18,"\u{1F5D1}\uFE0F"),t()()()()}if(l&2){let e=o.$implicit;s(2),f(e.username),s(2),f(e.email||"-"),s(3),f(e.role),s(2),f(e.facilityName||"-"),s(2),c("ngClass",e.isActive?"badge-success":"badge-danger"),s(),y(" ",e.isActive?"Active":"Inactive"," ")}}function se(l,o){if(l&1){let e=x();n(0,"div",19),d("click",function(){p(e);let a=m();return u(a.closeForms())}),n(1,"div",20),d("click",function(a){return p(e),u(a.stopPropagation())}),n(2,"div",21)(3,"h2"),i(4),t(),n(5,"button",22),d("click",function(){p(e);let a=m();return u(a.closeForms())}),i(6,"\xD7"),t()(),n(7,"form",23),d("ngSubmit",function(){p(e);let a=m();return u(a.onSubmit())}),n(8,"div",24)(9,"label"),i(10,"Username *"),t(),_(11,"input",25),t(),n(12,"div",24)(13,"label"),i(14),t(),_(15,"input",26),t(),n(16,"div",24)(17,"label"),i(18,"Email"),t(),_(19,"input",27),t(),n(20,"div",24)(21,"label"),i(22,"Role *"),t(),n(23,"select",28)(24,"option",29),i(25,"Health Worker"),t(),n(26,"option",29),i(27,"Facility Manager"),t(),n(28,"option",29),i(29,"Government Official"),t()()(),n(30,"div",24)(31,"label"),i(32,"First Name"),t(),_(33,"input",30),t(),n(34,"div",24)(35,"label"),i(36,"Last Name"),t(),_(37,"input",31),t(),n(38,"div",24)(39,"label"),i(40,"Facility ID"),t(),_(41,"input",32),t(),n(42,"div",33)(43,"button",34),d("click",function(){p(e);let a=m();return u(a.closeForms())}),i(44,"Cancel"),t(),n(45,"button",35),i(46),t()()()()()}if(l&2){let e=m();s(4),f(e.showEditForm?"Edit User":"Create User"),s(3),c("formGroup",e.userForm),s(4),c("readonly",e.showEditForm),s(3),y("Password ",e.showEditForm?"(leave blank to keep current)":"*"),s(10),c("value",e.UserRole.HEALTH_WORKER),s(2),c("value",e.UserRole.FACILITY_MANAGER),s(2),c("value",e.UserRole.GOVERNMENT_OFFICIAL),s(17),c("disabled",e.userForm.invalid||e.loading),s(),y(" ",e.showEditForm?"Update":"Create"," ")}}function le(l,o){l&1&&_(0,"app-loader")}var Z=class l{constructor(o,e){this.userService=o;this.fb=e;this.userForm=this.fb.group({username:["",[h.required]],password:["",[h.required,h.minLength(6)]],email:[""],role:["HEALTH_WORKER",[h.required]],facilityId:[""],firstName:[""],lastName:[""]})}users=[];loading=!1;showCreateForm=!1;showEditForm=!1;selectedUser=null;showDeleteModal=!1;userToDelete=null;errorMessage="";successMessage="";userForm;UserRole=V;ngOnInit(){this.loadUsers()}loadUsers(){this.loading=!0;let o=Date.now();if(D.useMockAuth){setTimeout(()=>{this.loadMockUsers(),g(o,()=>{this.loading=!1})},300);return}this.userService.getAllUsers().subscribe({next:e=>{this.users=e,g(o,()=>{this.loading=!1})},error:e=>{console.warn("Failed to load users, using mock data:",e),this.loadMockUsers(),g(o,()=>{this.loading=!1})}})}loadMockUsers(){this.users=[{id:"1",username:"vaccinator",email:"vaccinator@vaxtrack.com",role:"HEALTH_WORKER",facilityId:"FAC001",facilityName:"Mvog-Ada Health Center",fullName:"Dr. Sarah Mbah",firstName:"Sarah",lastName:"Mbah",isActive:!0,active:!0,status:"ACTIVE"},{id:"2",username:"manager",email:"manager@vaxtrack.com",role:"FACILITY_MANAGER",facilityId:"FAC001",facilityName:"Mvog-Ada Health Center",fullName:"John Manager",firstName:"John",lastName:"Manager",isActive:!0,active:!0,status:"ACTIVE"},{id:"3",username:"admin",email:"admin@vaxtrack.com",role:"GOVERNMENT_OFFICIAL",facilityId:"",facilityName:"System Administration",fullName:"System Admin",firstName:"System",lastName:"Admin",isActive:!0,active:!0,status:"ACTIVE"},{id:"4",username:"district",email:"district@vaxtrack.com",role:"GOVERNMENT_OFFICIAL",facilityId:"",facilityName:"District Office",fullName:"District Officer",firstName:"District",lastName:"Officer",isActive:!0,active:!0,status:"ACTIVE"}]}openCreateForm(){this.userForm.reset({role:"HEALTH_WORKER"}),this.showCreateForm=!0,this.showEditForm=!1}openEditForm(o){this.selectedUser=o,this.userForm.patchValue({username:o.username,email:o.email||"",role:o.role,facilityId:o.facilityId||"",firstName:o.firstName||"",lastName:o.lastName||""}),this.userForm.get("password")?.clearValidators(),this.userForm.get("password")?.updateValueAndValidity(),this.showEditForm=!0,this.showCreateForm=!1}closeForms(){this.showCreateForm=!1,this.showEditForm=!1,this.selectedUser=null,this.userForm.reset()}onSubmit(){if(this.userForm.valid){this.loading=!0;let o=Date.now(),e=this.userForm.value;if(this.showEditForm&&this.selectedUser){let r=T({},e);r.password||delete r.password,this.userService.updateUser(this.selectedUser.id,r).subscribe({next:()=>{this.successMessage="User updated successfully",this.closeForms(),g(o,()=>{this.loadUsers(),this.loading=!1})},error:a=>{this.errorMessage="Failed to update user",g(o,()=>{this.loading=!1})}})}else this.userService.createUser(e).subscribe({next:()=>{this.successMessage="User created successfully",this.closeForms(),g(o,()=>{this.loadUsers(),this.loading=!1})},error:r=>{this.errorMessage="Failed to create user",g(o,()=>{this.loading=!1})}})}}openDeleteModal(o){this.userToDelete=o,this.showDeleteModal=!0}confirmDelete(){if(this.userToDelete){this.loading=!0;let o=Date.now();this.userService.deleteUser(this.userToDelete.id).subscribe({next:()=>{this.successMessage="User deleted successfully",this.showDeleteModal=!1,this.userToDelete=null,g(o,()=>{this.loadUsers(),this.loading=!1})},error:e=>{this.errorMessage="Failed to delete user",g(o,()=>{this.loading=!1})}})}}cancelDelete(){this.showDeleteModal=!1,this.userToDelete=null}static \u0275fac=function(e){return new(e||l)(P(X),P(K))};static \u0275cmp=v({type:l,selectors:[["app-admin-users"]],decls:33,vars:7,consts:[[1,"admin-users"],[1,"page-header"],[1,"subtitle"],[1,"btn","btn-primary",3,"click"],["type","error",3,"message","show","dismiss",4,"ngIf"],["type","success",3,"message","show","dismiss",4,"ngIf"],[1,"users-table-container"],[1,"users-table"],[4,"ngFor","ngForOf"],["class","modal-overlay",3,"click",4,"ngIf"],["title","Delete User","confirmText","Delete","cancelText","Cancel","type","danger",3,"confirmed","cancelled","show","message"],[4,"ngIf"],["type","error",3,"dismiss","message","show"],["type","success",3,"dismiss","message","show"],[1,"badge","badge-info"],[1,"badge",3,"ngClass"],[1,"action-buttons"],["title","Edit",1,"btn-icon",3,"click"],["title","Delete",1,"btn-icon","btn-danger",3,"click"],[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"modal-header"],[1,"modal-close",3,"click"],[1,"modal-body",3,"ngSubmit","formGroup"],[1,"form-group"],["type","text","formControlName","username",1,"form-control",3,"readonly"],["type","password","formControlName","password",1,"form-control"],["type","email","formControlName","email",1,"form-control"],["formControlName","role",1,"form-control"],[3,"value"],["type","text","formControlName","firstName",1,"form-control"],["type","text","formControlName","lastName",1,"form-control"],["type","text","formControlName","facilityId",1,"form-control"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled"]],template:function(e,r){e&1&&(n(0,"app-layout")(1,"div",0)(2,"div",1)(3,"div")(4,"h1"),i(5,"User Management"),t(),n(6,"p",2),i(7,"Manage system users and their access"),t()(),n(8,"button",3),d("click",function(){return r.openCreateForm()}),i(9,"+ Add User"),t()(),b(10,oe,1,2,"app-alert",4)(11,re,1,2,"app-alert",5),n(12,"div",6)(13,"table",7)(14,"thead")(15,"tr")(16,"th"),i(17,"Username"),t(),n(18,"th"),i(19,"Email"),t(),n(20,"th"),i(21,"Role"),t(),n(22,"th"),i(23,"Facility"),t(),n(24,"th"),i(25,"Status"),t(),n(26,"th"),i(27,"Actions"),t()()(),n(28,"tbody"),b(29,ae,19,6,"tr",8),t()()(),b(30,se,47,9,"div",9),n(31,"app-confirmation-modal",10),d("confirmed",function(){return r.confirmDelete()})("cancelled",function(){return r.cancelDelete()}),t(),b(32,le,1,0,"app-loader",11),t()()),e&2&&(s(10),c("ngIf",r.errorMessage),s(),c("ngIf",r.successMessage),s(18),c("ngForOf",r.users),s(),c("ngIf",r.showCreateForm||r.showEditForm),s(),c("show",r.showDeleteModal)("message","Are you sure you want to delete user "+((r.userToDelete==null?null:r.userToDelete.username)||"")+"?"),s(),c("ngIf",r.loading))},dependencies:[O,M,I,w,B,G,q,W,R,Y,z,L,H,j,N,Q,$,J,k],styles:[".admin-users[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:700;color:#333;margin:0 0 .5rem}.page-header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{color:#666;font-size:1.1rem;margin:0}.users-table-container[_ngcontent-%COMP%]{background:#fff;border-radius:12px;box-shadow:0 2px 8px #0000001a;overflow-x:auto}.users-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.users-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:#f8f9fa}.users-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:1rem;text-align:left;font-weight:600;color:#333;border-bottom:2px solid #e0e0e0}.users-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:1rem;border-bottom:1px solid #f0f0f0}.users-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#f8f9fa}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:.5rem}.btn-icon[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;font-size:1.2rem;padding:.25rem .5rem;border-radius:4px;transition:all .2s}.btn-icon[_ngcontent-%COMP%]:hover{background:#f0f0f0}.btn-icon.btn-danger[_ngcontent-%COMP%]:hover{background:#f8d7da}.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#0009;display:flex;justify-content:center;align-items:center;z-index:10000;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.modal-content[_ngcontent-%COMP%]{background:#fff;border-radius:12px;max-width:600px;width:90%;max-height:90vh;overflow-y:auto;box-shadow:0 10px 40px #0003}.modal-header[_ngcontent-%COMP%]{padding:1.5rem;border-bottom:1px solid #e0e0e0;display:flex;justify-content:space-between;align-items:center}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;font-weight:600}.modal-close[_ngcontent-%COMP%]{background:none;border:none;font-size:1.5rem;cursor:pointer;color:#666;padding:0;width:32px;height:32px;display:flex;align-items:center;justify-content:center;border-radius:4px;transition:all .2s}.modal-close[_ngcontent-%COMP%]:hover{background:#f0f0f0}.modal-body[_ngcontent-%COMP%]{padding:1.5rem}.form-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;color:#333;font-weight:500}.form-control[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:2px solid #e0e0e0;border-radius:8px;font-size:1rem;transition:all .2s;box-sizing:border-box}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#667eea;box-shadow:0 0 0 3px #667eea1a}.form-control[readonly][_ngcontent-%COMP%]{background:#f8f9fa;cursor:not-allowed}.modal-footer[_ngcontent-%COMP%]{padding:1.5rem;border-top:1px solid #e0e0e0;display:flex;justify-content:flex-end;gap:1rem}.btn[_ngcontent-%COMP%]{padding:.75rem 1.5rem;border:none;border-radius:8px;font-size:1rem;font-weight:600;cursor:pointer;transition:all .2s}.btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 4px 12px #667eea66}.btn-secondary[_ngcontent-%COMP%]{background:#f0f0f0;color:#333}.btn-secondary[_ngcontent-%COMP%]:hover{background:#e0e0e0}.badge[_ngcontent-%COMP%]{padding:.25rem .75rem;border-radius:12px;font-size:.8rem;font-weight:500}.badge-success[_ngcontent-%COMP%]{background:#d4edda;color:#155724}.badge-danger[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24}.badge-info[_ngcontent-%COMP%]{background:#d1ecf1;color:#0c5460}@media(max-width:768px){.page-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:1rem}.users-table[_ngcontent-%COMP%]{font-size:.9rem}}"]})};export{Z as AdminUsersComponent};
