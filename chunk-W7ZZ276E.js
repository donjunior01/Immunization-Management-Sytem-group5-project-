import{b as l}from"./chunk-K3XQKY74.js";import{bb as o,db as h,i as r,j as d,k as a,n as u,v as c,z as f}from"./chunk-T4RMSDZY.js";var g=class m{http=f(h);apiUrl=l.apiUrl;getAppointments(t,n){let e=new o;return t&&(e=e.set("facilityId",t)),n&&(e=e.set("date",n)),this.http.get(`${this.apiUrl}/appointments`,{params:e}).pipe(d(8e3),a(i=>i.map(p=>this.mapBackendToFrontend(p))),u(i=>(console.error("Error fetching appointments:",i),r(()=>i))))}mapBackendToFrontend(t){let n="";if(t.appointmentDate){if(typeof t.appointmentDate=="string")n=t.appointmentDate;else if(t.appointmentDate.year&&t.appointmentDate.month&&t.appointmentDate.day){let i=t.appointmentDate.year,p=String(t.appointmentDate.monthValue||t.appointmentDate.month).padStart(2,"0"),D=String(t.appointmentDate.dayOfMonth||t.appointmentDate.day).padStart(2,"0");n=`${i}-${p}-${D}`}}let e;if(t.appointmentTime){if(typeof t.appointmentTime=="string")e=t.appointmentTime;else if(t.appointmentTime.hour!==void 0){let i=String(t.appointmentTime.hour).padStart(2,"0"),p=String(t.appointmentTime.minute||0).padStart(2,"0");e=`${i}:${p}`}}return{id:t.id?String(t.id):"",patientId:t.patientId?String(t.patientId):"",patientName:t.patientName||"Unknown",patientAge:t.patientAge||void 0,guardianName:t.guardianName||void 0,guardianPhone:t.guardianPhone||t.phoneNumber||void 0,vaccineName:t.vaccineName||"",doseNumber:t.doseNumber||1,appointmentDate:n,appointmentTime:e,facilityId:t.facilityId||"",facilityName:t.facilityName||void 0,status:t.status||"SCHEDULED",notes:t.notes||void 0,smsSent:t.smsSent||!1,smsSentDate:t.smsSentDate||t.smsSentAt||void 0,createdAt:t.createdAt||new Date().toISOString()}}getAppointmentById(t){return this.http.get(`${this.apiUrl}/appointments/${t}`).pipe(a(n=>this.mapBackendToFrontend(n)))}createAppointment(t){return this.http.post(`${this.apiUrl}/appointments`,t).pipe(a(n=>this.mapBackendToFrontend(n)))}updateAppointment(t,n){return this.http.put(`${this.apiUrl}/appointments/${t}`,n).pipe(a(e=>this.mapBackendToFrontend(e)))}deleteAppointment(t){return this.http.delete(`${this.apiUrl}/appointments/${t}`)}getPatientAppointments(t){let n=new o().set("patientId",t);return this.http.get(`${this.apiUrl}/appointments`,{params:n}).pipe(a(e=>e.map(i=>this.mapBackendToFrontend(i))))}static \u0275fac=function(n){return new(n||m)};static \u0275prov=c({token:m,factory:m.\u0275fac,providedIn:"root"})};export{g as a};
