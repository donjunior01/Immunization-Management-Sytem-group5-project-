import{b as d}from"./chunk-H32AX7W2.js";import{bb as p,db as m,k as n,v as o,z as r}from"./chunk-T4RMSDZY.js";var g=class i{http=r(m);apiUrl=d.apiUrl;getSmsLogs(t){let e=new p;return t?.startDate&&t.startDate.trim()!==""&&(e=e.set("startDate",t.startDate)),t?.endDate&&t.endDate.trim()!==""&&(e=e.set("endDate",t.endDate)),t?.status&&t.status.trim()!==""&&(e=e.set("status",t.status)),t?.recipientPhone&&t.recipientPhone.trim()!==""&&(e=e.set("recipient_phone",t.recipientPhone)),fetch("http://127.0.0.1:7243/ingest/beb0f3e8-0ff1-4b21-b2a4-519a994a184e",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"sms.service.ts:getSmsLogs",message:"Calling SMS logs API",data:{url:`${this.apiUrl}/api/sms-logs`,hasFilter:!!t,paramsCount:e.keys().length},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"SMS_LOADING"})}).catch(()=>{}),this.http.get(`${this.apiUrl}/api/sms-logs`,{params:e}).pipe(n(s=>s.map(a=>({id:String(a.id||""),recipientPhone:a.recipientPhone||"",message:a.message||"",status:a.status||"PENDING",sentAt:a.sentAt||"",errorMessage:a.errorMessage||"",appointmentId:a.appointmentId||"",patientId:a.patientId||""}))))}getSmsLogById(t){return this.http.get(`${this.apiUrl}/api/sms-logs/${t}`)}sendSms(t,e){return fetch("http://127.0.0.1:7243/ingest/beb0f3e8-0ff1-4b21-b2a4-519a994a184e",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"sms.service.ts:sendSms",message:"Sending SMS request",data:{phone:t,messageLength:e?.length||0},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"SMS_SEND"})}).catch(()=>{}),this.http.post(`${this.apiUrl}/api/sms-logs/send`,{phone:t,message:e}).pipe(n(s=>({id:String(s.id||""),recipientPhone:s.recipientPhone||"",message:s.message||"",status:s.status||"PENDING",sentAt:s.sentAt||"",errorMessage:s.errorMessage||"",appointmentId:s.appointmentId||"",patientId:s.patientId||""})))}deleteSmsLog(t){return fetch("http://127.0.0.1:7243/ingest/beb0f3e8-0ff1-4b21-b2a4-519a994a184e",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"sms.service.ts:deleteSmsLog",message:"Deleting SMS log",data:{smsLogId:t},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"SMS_DELETE"})}).catch(()=>{}),this.http.delete(`${this.apiUrl}/api/sms-logs/${t}`)}static \u0275fac=function(e){return new(e||i)};static \u0275prov=o({token:i,factory:i.\u0275fac,providedIn:"root"})};export{g as a};
